<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0068)http://localhost:8080/MessageServlet?oper=revertMessage&messageId=27 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!--<base href="http://localhost:8080/">--><base href=".">
    
    <title>回复留言</title>
    
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">    
	<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
	<meta http-equiv="description" content="This is my page">
	<link href="./回复留言_files/common.css" type="text/css" rel="stylesheet">
	<script type="text/javascript" src="./回复留言_files/ckeditor.js.下载"></script>
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/colResizable-1.3.min.js"></script>
    <script type="text/javascript" src="../js/common.js"></script>
    <script src="../js/jquery/jquery.form.js"></script>
    <script src="../js/moment/moment.min.js"></script>
    <script src="../js/numeral/numeral.min.js"></script>
    <script src="../js/numeral/chs.min.js"></script>
    <script src="../js/common/base.js"></script>
    <script src="../js/common/normal.js"></script>
	<style type="text/css">
		.tab{ }
		.tab td{ border:solid 1px #85ACE0;}
		.tab1{ }
		.tab1 td{ border:#fff; }
	</style>
	

  <script type="text/javascript" src="./回复留言_files/config.js.下载"></script><style id="tsbrowser_video_independent_player_style" type="text/css">
      [tsbrowser_force_max_size] {
        width: 100% !important;
        height: 100% !important;
        left: 0px !important;
        top: 0px !important;
        margin: 0px !important;
        padding: 0px !important;
        transform: none !important;
      }
      [tsbrowser_force_fixed] {
        position: fixed !important;
        z-index: 9999 !important;
        background: black !important;
      }
      [tsbrowser_force_hidden] {
        opacity: 0 !important;
        z-index: 0 !important;
      }
      [tsbrowser_hide_scrollbar] {
        overflow: hidden !important;
      }
      [tsbrowser_display_none] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
      }
      [tsbrowser_force_show] {
        display: black !important;
        visibility: visible !important;
        opacity: 0;
      }</style><link rel="stylesheet" type="text/css" href="./回复留言_files/editor.css"><script type="text/javascript" src="./回复留言_files/zh-cn.js.下载"></script><script type="text/javascript" src="./回复留言_files/default.js.下载"></script></head>
  
  <body background="./回复留言_files/bookbg.gif" leftmargin="0" topmargin="3" marginheight="0" marginwidth="0">
	<div align="center">
		<a href="http://localhost:8080/MessageServlet"><img src="./回复留言_files/welcome.jpg"></a>
	</div>
	<div align="center">
		<table border="0" cellspacing="1" cellpadding="4" width="750" align="center">
			<tbody>
				<tr>
					<td class="unnamed2" height="20" colspan="2" align="right"><marquee onmouseover="stop();" onmouseout="start();" scrollamount="3">
							<b><font color="#000099">欢迎您使用&nbsp;留言本&nbsp;</font> </b>
						</marquee></td>
				</tr>
				<tr>
					<td><a style="margin-left:-5px;" href="http://localhost:8080/company/IndexServlet">首页</a>
						<font> &gt; </font><a href="http://localhost:8080/company/MessageServlet">留言板</a>
						<font> &gt; </font>回复留言
						<hr style="margin-left:-5px;">
					</td>
				</tr>
			</tbody>
		</table>
		<div style="WIDTH: 750px" align="center">
			<div align="left">
				<table border="0" cellspacing="0" cellpadding="0" height="20">
					<tbody>
						<tr>
							<td background="./回复留言_files/titlemu_1.gif" width="11"></td>
							<td background="./回复留言_files/titlemu_2.gif">
								<div align="center">
									<a class="jdmenu"><b>留言</b>
									</a>
								</div>
							</td>
							<td background="./回复留言_files/titlemu_3.gif" width="12"></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<!-- 显示留言内容 -->
		<table style="BORDER-COLLAPSE: collapse" border="0" cellspacing="0" bordercolor="#111111" cellpadding="0" width="750" align="center">
			<tbody>
				<tr>
					<td width="2%"><img border="0" src="./回复留言_files/T_left.gif">
					</td>
					<td width="96%"><img src="./回复留言_files/Tt_bg.jpg" width="554" height="24" style="margin-top:3px;"></td>
					<td width="2%"><img border="0" src="./回复留言_files/T_right.gif">
					</td>
				</tr>
			</tbody>
		</table>
		<table style="BORDER-COLLAPSE: collapse; WORD-WRAP: break-word;" cellspacing="0" cellpadding="3" width="750" align="center" height="51" class="tab">
			<tbody>
            <tr>
				<td style="background-color:#FFE8E8;">

                    <div>
                    <span style="font-weight:bold;">标题：</span>
                    <span id="mtitle"></span>
                    </div>
                </td>
			</tr>
			<tr>
				<td height="150">
                    <div id="mcontent"></div>
                </td>
			</tr>
			<tr>
                <td><div><span id="mwriter"></span>写于<span id="mwriteDate"></span></div></td>
			</tr>
		</tbody>
        </table>
		<table style="BORDER-COLLAPSE: collapse" border="0" cellspacing="0" cellpadding="0" width="750" align="center">
			<tbody>
				<tr>
					<td><img border="0" src="./回复留言_files/T_bottomleft.gif"></td>
					<td background="./回复留言_files/T_bottombg.gif" width="100%"></td>
					<td><img border="0" src="./回复留言_files/T_bottomright.gif"></td>
				</tr>
			</tbody>
		</table>
		<br>
		<div style="text-align:left;width:750px;margin:auto;"><h3>回复内容：</h3></div>			
		
			<table style="BORDER-COLLAPSE: collapse" border="0" cellspacing="0" bordercolor="#111111" cellpadding="0" width="750" align="center">
				<tbody>
					<tr>
						<td width="2%"><img border="0" src="./回复留言_files/T_left.gif">
						</td>
						<td width="96%"><img src="./回复留言_files/Tt_bg.jpg" width="554" height="24" style="margin-top:3px;"></td>
						<td width="2%"><img border="0" src="./回复留言_files/T_right.gif">
						</td>
					</tr>
				</tbody>
			</table>
			<table style="BORDER-COLLAPSE: collapse; WORD-WRAP: break-word;" cellspacing="0" cellpadding="3" width="750" align="center" height="51" class="tab">
				<!--回复区-->
                <tbody id="revert"></tbody>
            </table>
			<table style="BORDER-COLLAPSE: collapse" border="0" cellspacing="0" cellpadding="0" width="750" align="center">
				<tbody>
					<tr>
						<td><img border="0" src="./回复留言_files/T_bottomleft.gif"></td>
						<td background="./回复留言_files/T_bottombg.gif" width="100%"></td>
						<td><img border="0" src="./回复留言_files/T_bottomright.gif"></td>
					</tr>
				</tbody>
			</table>
			<br>		
		
		<form id="addRevert" method="post" name="form" onsubmit="return checkForm()">
			<table style="BORDER-COLLAPSE: collapse; WORD-WRAP: break-word;" cellspacing="0" cellpadding="3" width="750" align="center" height="51" class="tab">
				<tbody><tr>
					<td style="background-color:#FFE8E8;" align="center">快速回复</td>
				</tr>
				<tr>
					<td height="150">
						<table cellspacing="0" cellpadding="3" width="750" align="center" height="130" class="tab1">
							<tbody><tr>
								<td width="20%" align="right" style="border:#fff;">姓名：<input type="hidden" id="mId" name="messageId" value=""></td>
								<td><input type="text" size="20" name="writer"><span style="color:red;">&nbsp;&nbsp;*</span></td>
							</tr>
							<tr>
								<td align="right" style="border:#fff;">内容：</td>
								<td><textarea name="content" cols="70" rows="10" class="textarea"></textarea></td>
							</tr>
                            <tr>
                                <td align="right" style="border:#fff;">回复日期：</td>
                                <td>
                                    <input type="date" name="writeDate" class="input-text lh30" size="40">
                                </td>
                            </tr>
							<tr>
								<td align="center" colspan="2">
									<input type="hidden" name="messageId" value="27">
									<input type="button" value="提交" onclick="addRevert()">&nbsp;&nbsp;&nbsp;&nbsp;
									<input type="reset" value="重置">
								</td>
							</tr>
						</tbody></table>
					</td>
				</tr>
			</tbody></table>
		</form>
		<br>
		<br>
		<br>
	</div>
    <script>

        /**
         *  $(function(){})
         *  就是jQuery当中的一个初始化函数
         *  它在加载完页面文档之后会自动执行
         */
        $(function () {
            initReverts();
            var id = $.getHrefParam("id");
            $.post("/getMessageById",{"messageId":id},function (result) {
                var obj = $.dealJSONObj(result);
                // var id = obj.data.messageId;
                var title = obj.data.title;
                var content = obj.data.content;
                var writer = obj.data.writer;
                var writeDate = moment(obj.data.writeDate,'x').format("YYYY-MM-DD");// hh:mm:ss
                // var count = obj.data.count;

                // $("#updid").html(id);
                $("#mId").val(id);
                $("#mtitle").html(title);
                $("#mcontent").html(content);
                $("#mwriter").html(writer);
                $("#mwriteDate").html(writeDate);
                // $("#rcount").val(count);
            })

        })

        /**
         * 查看回复
         */
        function initReverts() {
            var id = $.getHrefParam("id");
            $.post("/initRevert",{"messageId":id},function (result) {
                var obj = $.dealJSONObj(result);
                /**
                 *code会返回一个0或者非0的数字，如果0，使用!obj.code就返回true，表示查询成功
                 */
                if(!obj.code){
                    var s = "";
                    //创建了一个带有占位符的字符串
                    var str =
                        "<tr>\n" +
                        "\t\t\t\t\t<td height=\"150\">\n" +
                        "                        <div>\n" +
                        "                            <p>{0}</p>\n" +
                        "                        </div>\n" +
                        "                    </td>\n" +
                        "\t\t\t\t</tr>\n" +
                        "\t\t\t\t<tr>\n" +
                        "\t\t\t\t\t<td><div>{1}写于{2}</div></td>\n" +
                        "\t\t\t\t</tr>";
                    //$.each就可以遍历集合，其中的v就相当于是一个users对象
                    $.each(obj.data, function (k, v) {
                        s += str.formatStr(
                            v.content,
                            v.writer,
                            moment(v.writeDate,'x').format("YYYY-MM-DD")
                        )
                    })
                    $("#revert").empty(); //$("#data")叫做jQuery的选择器，它是一个id选择器，用来得到id值为data的一个节点
                    $("#revert").html(s);
                }else {
                    alert(obj.msg)
                }
            })
        }

        /**
         * 创建回复
         */
        function addRevert() {
            $.post("/addRevert",$("#addRevert").serialize(),function (result) {
                var obj = $.dealJSONObj(result);
                if (!obj.code) {
                    alert("回复成功")
                    initReverts();
                }
            })
        }
    </script>
	<script>
		function checkForm(){
			var Form = document.form;
			var content = Form.content.value;
			var writer = Form.writer.value;
			if(writer=="" || content==""){
				alert("留言人和内容不能为空");
				return false;
			}
			return true;
		}	
	</script>


</body></html>